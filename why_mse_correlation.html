
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Why the correlation gives the best slope &#8212; Practice and theory of brain imaging</title>
    
  <link href="_static/css/theme.css" rel="stylesheet">
  <link href="_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/reggie.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Practice and theory of brain imaging</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="intro.html">
   Practice and theory of brain imaging
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  The neuroimaging problem
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="the_problem.html">
   The problem and the plan
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  The tools
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="to_code.html">
   Ode to code
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="surviving_computers.html">
   Surviving the computer
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="the_software.html">
   Our tools
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="using_jupyter.html">
   Using Jupyter notebooks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="more_on_jupyter.html">
   More on the Jupyter notebook
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="brisk_python.html">
   Brisk introduction to Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="installation.html">
   Installing on your computer
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Images and code and images
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="what_is_an_image.html">
   What is an image?
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="numpy_intro.html">
   Introduction to Numpy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="arrays_and_images.html">
   Arrays as images, images as arrays
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="arrays_3d.html">
   Three-dimensional arrays
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="images_3d.html">
   Three-dimensional images, NIfTI
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="reshape_and_3d.html">
   Reshaping and three-dimensional arrays
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="boolean_indexing.html">
   Indexing with Boolean arrays
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="boolean_indexing_nd.html">
   Boolean indexing with more than one dimension
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="intro_to_4d.html">
   Working with four dimensional images, masks and functions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="reshape_and_4d.html">
   Reshaping, 4D to 2D
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="voxels_by_time.html">
   Voxels and time
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Working reproducibly
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="on_modules.html">
   Modules and scripts
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="sys_path.html">
   Where does Python look for modules?
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="assert.html">
   Using
   <code class="docutils literal notranslate">
    <span class="pre">
     assert
    </span>
   </code>
   for testing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="path_manipulation.html">
   Making and breaking file paths in Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="coding_style.html">
   Python coding style
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="docstrings.html">
   Docstrings
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="module_directories.html">
   Module directories
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="on_testing.html">
   On testing
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Detecting activation
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="voxel_time_courses.html">
   Correlating with voxel time courses
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="on_convolution.html">
   Convolution
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="convolution_background.html">
   Convolving with the hemodyamic response function
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="on_regression.html">
   Introducing regression
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="regress_one_voxel.html">
   Regression for a single voxel
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="glm_intro.html">
   Introduction to the general linear model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="model_one_voxel.html">
   Modeling a single voxel
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="mean_test_example.html">
   A worked example of the general linear model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="multi_multiply.html">
   Estimation for many voxels at the same time
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="hypothesis_tests.html">
   Hypothesis testing with the general linear model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="test_one_voxel.html">
   Testing a single voxel
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="non_tr_onsets.html">
   Using onsets that do not start on a TR
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="whole_image_statistics.html">
   Whole-brain t tests and p values
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Arrays and plots
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="methods_vs_functions.html">
   Methods vs functions in NumPy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="allclose.html">
   Testing for near equality with “allclose”
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="arange.html">
   NumPy arange
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="numpy_logical.html">
   Logical operations on Boolean arrays
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="dot_outer.html">
   Vector and matrix dot products, “np.outer”
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="newaxis.html">
   Adding length 1 dimensions with newaxis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="array_reductions.html">
   Array reduction operations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="numpy_random.html">
   Numpy random number generators
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="subtract_means.html">
   Subtracting the mean from columns or rows
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="plot_lines.html">
   Plotting lines in matplotlib
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="subplots.html">
   Subplots and axes in matplotlib
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Coordinate systems and spatial transforms
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="diagonal_zooms.html">
   Encoding zooms (scaling) with a diagonal matrix
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="nibabel_affines.html">
   The
   <code class="docutils literal notranslate">
    <span class="pre">
     nibabel.affines
    </span>
   </code>
   module
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="nibabel_apply_affine.html">
   Applying coordinate transforms with
   <code class="docutils literal notranslate">
    <span class="pre">
     nibabel.affines.apply_affine
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="map_coordinates.html">
   General resampling between images with
   <code class="docutils literal notranslate">
    <span class="pre">
     scipy.ndimage.map_coordinates
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="image_header_and_affine.html">
   The image header and affine
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="images_and_affines.html">
   Images and affines
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="rotation_2d_3d.html">
   Rotations and rotation matrices
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="resampling_with_ndimage.html">
   Resampling with
   <code class="docutils literal notranslate">
    <span class="pre">
     scipy.ndimage
    </span>
   </code>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="dipy_registration.html">
   Registration with dipy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="anterior_cingulate.html">
   Anterior cingulate
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/why_mse_correlation.Rmd"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.Rmd</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/nipraxis/textbook"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/nipraxis/textbook/issues/new?title=Issue%20on%20page%20%2Fwhy_mse_correlation.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/nipraxis/textbook/main?urlpath=tree/why_mse_correlation.Rmd"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        <a class="jupyterhub-button" href="https://hub.nipraxis.org/hub/user-redirect/git-pull?repo=https://github.com/nipraxis/textbook&urlpath=tree/textbook/why_mse_correlation.Rmd&branch=main"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch JupyterHub" data-toggle="tooltip"
                data-placement="left"><img class="jupyterhub-button-logo"
                    src="_static/images/logo_jupyterhub.svg"
                    alt="Interact on JupyterHub">JupyterHub</button></a>
        
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Launch Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-example-regression-problem">
   The example regression problem
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#writing-sums">
   Writing sums
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#mean-and-standard-deviation">
   Mean and standard deviation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-z-score-transformation">
   The z-score transformation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#some-interesting-characteristics-of-z-scores">
   Some interesting characteristics of z-scores
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#addition-inside-sum">
     Addition inside sum
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#multiplication-by-constant-inside-sum">
     Multiplication by constant inside sum
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#sum-of-constant-value">
     Sum of constant value
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#characteristics-of-z-scores">
   Characteristics of z-scores
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-least-squares-line-for-z-scores">
   The least-squares line for z-scores
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Why the correlation gives the best slope</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-example-regression-problem">
   The example regression problem
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#writing-sums">
   Writing sums
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#mean-and-standard-deviation">
   Mean and standard deviation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-z-score-transformation">
   The z-score transformation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#some-interesting-characteristics-of-z-scores">
   Some interesting characteristics of z-scores
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#addition-inside-sum">
     Addition inside sum
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#multiplication-by-constant-inside-sum">
     Multiplication by constant inside sum
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#sum-of-constant-value">
     Sum of constant value
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#characteristics-of-z-scores">
   Characteristics of z-scores
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-least-squares-line-for-z-scores">
   The least-squares line for z-scores
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="why-the-correlation-gives-the-best-slope">
<h1>Why the correlation gives the best slope<a class="headerlink" href="#why-the-correlation-gives-the-best-slope" title="Permalink to this headline">¶</a></h1>
<p>In which we return to the <a class="reference internal" href="on_regression.html"><span class="doc std std-doc">simple regression</span></a> problem, and work through the mathematics to show why the correlation is the best least-squares slope for two z-scored arrays.</p>
<div class="section" id="the-example-regression-problem">
<h2>The example regression problem<a class="headerlink" href="#the-example-regression-problem" title="Permalink to this headline">¶</a></h2>
<p>As you remember, we have (fake) measured scores for a “psychopathy” personality
trait in 12 students. We also have a measure of how much sweat each student had on their palms, and we
call this a “clammy” score.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import numerical and plotting libraries</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">numpy.linalg</span> <span class="k">as</span> <span class="nn">npl</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="c1"># Only show 6 decimals when printing</span>
<span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">psychopathy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">11.416</span><span class="p">,</span> <span class="mf">4.514</span><span class="p">,</span> <span class="mf">12.204</span><span class="p">,</span> <span class="mf">14.835</span><span class="p">,</span>
                        <span class="mf">8.416</span><span class="p">,</span>  <span class="mf">6.563</span><span class="p">,</span> <span class="mf">17.343</span><span class="p">,</span> <span class="mf">13.02</span><span class="p">,</span>
                        <span class="mf">15.19</span><span class="p">,</span> <span class="mf">11.902</span><span class="p">,</span> <span class="mf">22.721</span><span class="p">,</span> <span class="mf">22.324</span><span class="p">])</span>
<span class="n">clammy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.389</span><span class="p">,</span>  <span class="mf">0.2</span><span class="p">,</span>    <span class="mf">0.241</span><span class="p">,</span>  <span class="mf">0.463</span><span class="p">,</span>
                   <span class="mf">4.585</span><span class="p">,</span>  <span class="mf">1.097</span><span class="p">,</span>  <span class="mf">1.642</span><span class="p">,</span>  <span class="mf">4.972</span><span class="p">,</span>
                   <span class="mf">7.957</span><span class="p">,</span>  <span class="mf">5.585</span><span class="p">,</span>  <span class="mf">5.527</span><span class="p">,</span>  <span class="mf">6.964</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">psychopathy</span><span class="p">,</span> <span class="n">clammy</span><span class="p">,</span> <span class="s1">&#39;+&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Psychopathy&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Clammy&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 0, &#39;Clammy&#39;)
</pre></div>
</div>
<img alt="_images/why_mse_correlation_3_1.png" src="_images/why_mse_correlation_3_1.png" />
</div>
</div>
<p>To get ourselves into a mathematical mood, we will rename our x-axis values to <code class="docutils literal notranslate"><span class="pre">x</span></code> and the y-axis values to <code class="docutils literal notranslate"><span class="pre">y</span></code>.  We will store the number of observations in both as <code class="docutils literal notranslate"><span class="pre">n</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">psychopathy</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">clammy</span>
<span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">n</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>12
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> are Numpy <em>arrays</em>, but we can also call them <em>vectors</em>.  Vector is just a technical and mathematical term for a one-dimensional array.</p>
<p>We are on a quest to find why it turned out that the correlation coefficient is
always the best (least squared error) slope for the z-scored versions of these vectors (1D arrays).  To find out why, we need to be able to be able to express these <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> vectors in the most general way possible — independent of the numbers we have here.</p>
<p><span class="math notranslate nohighlight">\(\newcommand{\yvec}{\vec{y}} \newcommand{\xvec}{\vec{x}} \newcommand{\evec}{\vec{\varepsilon}}\)</span></p>
<p>First, in mathematical notation, we will call our <code class="docutils literal notranslate"><span class="pre">x</span></code> array <span class="math notranslate nohighlight">\(\xvec\)</span>, to remind us that <code class="docutils literal notranslate"><span class="pre">x</span></code> is a vector of numbers, not just a single number.</p>
<p>Next we generalize <span class="math notranslate nohighlight">\(\xvec\)</span> to refer to any set of <span class="math notranslate nohighlight">\(n\)</span> numbers.  So, in our <code class="docutils literal notranslate"><span class="pre">x</span></code>
we have <code class="docutils literal notranslate"><span class="pre">n</span></code> specific numbers, but we generalize <span class="math notranslate nohighlight">\(\xvec\)</span> to mean a series of <span class="math notranslate nohighlight">\(n\)</span> numbers, where <span class="math notranslate nohighlight">\(n\)</span> can be any number.  We can therefore write <span class="math notranslate nohighlight">\(\xvec\)</span> mathematically as:</p>
<div class="math notranslate nohighlight">
\[
\xvec = [x_1, x_2, x_3, ..., x_n]
\]</div>
<p>By this we mean that we take <span class="math notranslate nohighlight">\(\xvec\)</span> to be a vector (1D array) of any <span class="math notranslate nohighlight">\(n\)</span>
numbers.</p>
<p>By the same logic, we generalize the array <code class="docutils literal notranslate"><span class="pre">y</span></code> as the vector <span class="math notranslate nohighlight">\(\yvec\)</span>:</p>
<div class="math notranslate nohighlight">
\[
\yvec = [y_1, y_2, y_3, ..., y_n]
\]</div>
</div>
<div class="section" id="writing-sums">
<h2>Writing sums<a class="headerlink" href="#writing-sums" title="Permalink to this headline">¶</a></h2>
<p>We are next going to do the z-score transform on <span class="math notranslate nohighlight">\(\xvec\)</span> and <span class="math notranslate nohighlight">\(\yvec\)</span>.  As you remember, this involves subtracting the mean and dividing by the standard deviation.   We need to be able express these mathematically.</p>
<p>To do this we will use <a class="reference external" href="https://matthew-brett.github.io/teaching/some_sums.html">sum
notation</a>.  This uses
the symbol <span class="math notranslate nohighlight">\(\Sigma\)</span> to mean adding up the values in a vector.  <span class="math notranslate nohighlight">\(\Sigma\)</span> is
capital S in the Greek alphabet.   It is just a shorthand for the operation we
are used to calling <code class="docutils literal notranslate"><span class="pre">sum</span></code> in code.   So:</p>
<div class="math notranslate nohighlight">
\[
\Sigma_{i=1}^{n} x_i = x_1 + x_2 + x_3 ... + x_n
\]</div>
<p>The <span class="math notranslate nohighlight">\(i\)</span> above is the <em>index</em> for the vector, so <span class="math notranslate nohighlight">\(x_i\)</span> means the element from the vector at position <span class="math notranslate nohighlight">\(i\)</span>.  So, if <span class="math notranslate nohighlight">\(i = 3\)</span> then <span class="math notranslate nohighlight">\(x_i\)</span> is <span class="math notranslate nohighlight">\(x_3\)</span> — the element at the third position in the vector.</p>
<p>Therefore, in code we, can write <span class="math notranslate nohighlight">\(\Sigma_{i=1}^{n} x_i\)</span> as:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>160.448
</pre></div>
</div>
</div>
</div>
<p>The <span class="math notranslate nohighlight">\(i=1\)</span> and <span class="math notranslate nohighlight">\(n\)</span> at the bottom and top of the <span class="math notranslate nohighlight">\(\Sigma\)</span> mean that adding should
start at position 1 (<span class="math notranslate nohighlight">\(x_1\)</span>) and go up to position <span class="math notranslate nohighlight">\(n\)</span> (<span class="math notranslate nohighlight">\(x_n\)</span>).  Of course, this
means all the numbers in the vector.   In this page, we will always sum across all the numbers in the vector, and we will miss off the <span class="math notranslate nohighlight">\(i=1\)</span> and <span class="math notranslate nohighlight">\(n\)</span> above and below the <span class="math notranslate nohighlight">\(\Sigma\)</span>, so we will write:</p>
<div class="math notranslate nohighlight">
\[
\Sigma x_i
\]</div>
<p>when we mean:</p>
<div class="math notranslate nohighlight">
\[
\Sigma_{i=1}^{n} x_i
\]</div>
</div>
<div class="section" id="mean-and-standard-deviation">
<h2>Mean and standard deviation<a class="headerlink" href="#mean-and-standard-deviation" title="Permalink to this headline">¶</a></h2>
<p>Now we have a notation for adding things up in a vector, we can write the mathematical notation for the mean and standard deviation.</p>
<div class="math notranslate nohighlight">
\[
\newcommand{\xbar}{\bar{x}}
\newcommand{\ybar}{\bar{y}}
\]</div>
<p>We write the mean of a vector <span class="math notranslate nohighlight">\(\xvec\)</span> as <span class="math notranslate nohighlight">\(\xbar\)</span>.  Say <span class="math notranslate nohighlight">\(\xbar\)</span> as “x bar”.  The
definition of the mean is:</p>
<div class="math notranslate nohighlight">
\[
\xbar = \frac{1}{n} \Sigma x_i
\]</div>
<p>Read this as <em>add up all the elements in <span class="math notranslate nohighlight">\(\xvec\)</span> and divide by <span class="math notranslate nohighlight">\(n\)</span></em>.  In code:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculation of the mean.</span>
<span class="n">x_bar</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">/</span> <span class="n">n</span>
<span class="n">x_bar</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>13.370666666666667
</pre></div>
</div>
</div>
</div>
<p>The mean of <span class="math notranslate nohighlight">\(\yvec\)</span> is:</p>
<div class="math notranslate nohighlight">
\[
\ybar = \frac{1}{n} \Sigma y_i
\]</div>
<p>The standard deviation is the square root of the variance.  The variance is the mean squared deviation.  The deviation for each element is the result of subtracting the mean from the element.  Call the variance <span class="math notranslate nohighlight">\(\sigma^2\)</span>.  Read this as “sigma squared”.  Call the standard deviation <span class="math notranslate nohighlight">\(\sigma\)</span>.</p>
<p>In code:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">deviations</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="n">x_bar</span>
<span class="n">sigma_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">deviations</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="n">n</span>  <span class="c1"># Variance</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">sigma_2</span><span class="p">)</span>  <span class="c1"># Standard deviation</span>
<span class="n">sigma</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>5.366718136399149
</pre></div>
</div>
</div>
</div>
<p>Here is the calculation of <code class="docutils literal notranslate"><span class="pre">np.std</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>5.366718136399149
</pre></div>
</div>
</div>
</div>
<p>This is how we write the variance in mathematical notation:</p>
<div class="math notranslate nohighlight">
\[
\sigma^2 = \frac{1}{n} \Sigma (x_i - \xbar)^2
\]</div>
<p>Therefore:</p>
<div class="math notranslate nohighlight">
\[
\sigma = \sqrt{\sigma^2}
\]</div>
<p>We can be more specific about which vector we are referring to, by adding the
vector name as a subscript.  For example, if we mean the standard deviation for
<span class="math notranslate nohighlight">\(\xvec\)</span>, we could write this as <span class="math notranslate nohighlight">\(\sigma_x\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\sigma_x^2 = \frac{1}{n} \Sigma (x_i - \xbar)^2 \\
\sigma_x = \sqrt{\sigma_x^2}
\end{split}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sigma_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">sigma_x</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>5.366718136399149
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="the-z-score-transformation">
<h2>The z-score transformation<a class="headerlink" href="#the-z-score-transformation" title="Permalink to this headline">¶</a></h2>
<p>The z-score transformation is to subtract the mean and divide by the standard deviation:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">z_x</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">x_bar</span><span class="p">)</span> <span class="o">/</span> <span class="n">sigma_x</span>
<span class="n">z_x</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([-0.36422 , -1.650295, -0.217389,  0.272855, -0.923221, -1.268497,
        0.740179, -0.065341,  0.339003, -0.273662,  1.742281,  1.668307])
</pre></div>
</div>
</div>
</div>
<div class="math notranslate nohighlight">
\[
\newcommand{\zxvec}{\vec{z_x}}
\newcommand{\zyvec}{\vec{z_y}}
\]</div>
<p>Write the z-scores corresponding to <span class="math notranslate nohighlight">\(\xvec\)</span> as <span class="math notranslate nohighlight">\(\zxvec\)</span>:</p>
<div class="math notranslate nohighlight">
\[
\zxvec = [ (x_1 - \xbar) / \sigma_x, (x_2 - \xbar) / \sigma_x, ...
           (x_n - \xbar) / \sigma_x ]
\]</div>
<p>That is the same as saying:</p>
<div class="math notranslate nohighlight">
\[
z_{x_i} = (x_i - \xbar) / \sigma_x
\]</div>
</div>
<div class="section" id="some-interesting-characteristics-of-z-scores">
<h2>Some interesting characteristics of z-scores<a class="headerlink" href="#some-interesting-characteristics-of-z-scores" title="Permalink to this headline">¶</a></h2>
<p>Z-score vectors have a couple of interesting and important mathematical properties.</p>
<p>They have a sum of zero (within the calculation precision of the computer):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">z_x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>6.661338147750939e-16
</pre></div>
</div>
</div>
</div>
<p>Therefore they also have a mean of (near as dammit) zero.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">z_x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>5.551115123125783e-17
</pre></div>
</div>
</div>
</div>
<p>The z-scores have a standard deviation of (near-as-dammit) 1, and therefore, a variance of 1:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">z_x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.9999999999999999
</pre></div>
</div>
</div>
</div>
<p>This is true for any vector <span class="math notranslate nohighlight">\(\xvec\)</span> (or <span class="math notranslate nohighlight">\(\yvec\)</span>).  Why?</p>
<p>To answer that question, we need the results from the <a class="reference external" href="https://matthew-brett.github.io/teaching/some_sums.html">algebra of
sums</a>.  If you read that short page, you fill find that these general results hold:</p>
<div class="section" id="addition-inside-sum">
<h3>Addition inside sum<a class="headerlink" href="#addition-inside-sum" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[\begin{split}
\Sigma (x_i + y_i) = \\
(x_1 + y_1) + (x_2 + y_2) + \cdots (x_n + y_n) = \\
(x_1 + x_2 + \cdots x_n) + (y_1 + y_2 + \cdots y_n) = \\
\Sigma x_i + \Sigma y_i
\end{split}\]</div>
</div>
<div class="section" id="multiplication-by-constant-inside-sum">
<h3>Multiplication by constant inside sum<a class="headerlink" href="#multiplication-by-constant-inside-sum" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[\begin{split}
\Sigma c x_i = \\
c x_1 + c x_2 + \cdots c x_n = \\
c (x_1 + x_2 + \cdots x_n) = \\
c \Sigma x_i
\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(c\)</span> is some constant (number).</p>
</div>
<div class="section" id="sum-of-constant-value">
<h3>Sum of constant value<a class="headerlink" href="#sum-of-constant-value" title="Permalink to this headline">¶</a></h3>
<div class="math notranslate nohighlight">
\[
\Sigma_{i=1}^n c = c + c + ... + c = n c
\]</div>
</div>
</div>
<div class="section" id="characteristics-of-z-scores">
<h2>Characteristics of z-scores<a class="headerlink" href="#characteristics-of-z-scores" title="Permalink to this headline">¶</a></h2>
<p>With the results above, we can prove z-scores have a sum of 0:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\Sigma z_x = \Sigma ((x_i - \xbar) / \sigma_x) \\
= \sigma_x \Sigma (x_i - \xbar) \\
= \sigma_x (\Sigma x_i - \Sigma \xbar) \\
= \sigma_x (n \xbar - n \xbar) \\
= 0
\end{split}\]</div>
<p>Therefore, it is always true that the sum and mean of a z-score vector are 0.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\Sigma z_x = 0 \\
\bar{z_x} = 0
\end{split}\]</div>
<p>Next we show z-scores have a variance, and therefore, standard deviation, of 1.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\sigma^2_{z_x} = \frac{1}{n} \Sigma (z_{x_i} - \bar{z_x})^2 \\
= \frac{1}{n} \Sigma (z_{x_i})^2 \\
= \frac{1}{n} \Sigma ((x_i - \xbar) / \sigma_x)^2 \\
= \frac{1}{\sigma_x^2} \frac{1}{n} \Sigma (x_i - \xbar)^2 \\
= \frac{1}{\sigma_x^2} \sigma^2_x \\
= 1
\end{split}\]</div>
<p>Thus we have learned that:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\sigma^2_{z_x} = 1 \\
\sigma_{z_x} = 1
\end{split}\]</div>
<p>Because <span class="math notranslate nohighlight">\(\sigma^2_{z_x} = \frac{1}{n} \Sigma (z_{x_i})^2 = 1\)</span>:</p>
<div class="math notranslate nohighlight">
\[
\Sigma (z_{x_i})^2 = n \sigma^2_{z_x} = n
\]</div>
</div>
<div class="section" id="the-least-squares-line-for-z-scores">
<h2>The least-squares line for z-scores<a class="headerlink" href="#the-least-squares-line-for-z-scores" title="Permalink to this headline">¶</a></h2>
<p>Let us say we have a data vector <span class="math notranslate nohighlight">\(\yvec\)</span>.  We have somehow calculated a fitted value <span class="math notranslate nohighlight">\(f_i\)</span> for every corresponding value <span class="math notranslate nohighlight">\(y_i\)</span> in <span class="math notranslate nohighlight">\(\yvec\)</span>.  Then the errors at each value <span class="math notranslate nohighlight">\(i\)</span> are given by:</p>
<div class="math notranslate nohighlight">
\[
e_i = y_i - f_i
\]</div>
<p>and the sum of squared errors are:</p>
<div class="math notranslate nohighlight">
\[
SSE = \Sigma (y_i - f_i)^2
\]</div>
<p>Remembering that <span class="math notranslate nohighlight">\((a + b)^2 = (a + b)(a + b) = a^2 + 2ab + b^2\)</span> we get:</p>
<div class="math notranslate nohighlight">
\[
SSE = \Sigma (y_i^2 - 2y_i f_i + f_i^2)
\]</div>
<p>Simplifying with rules of sums above:</p>
<div class="math notranslate nohighlight">
\[
SSE = \Sigma y_i^2 - 2 \Sigma y_i f_i + \Sigma f_i^2
\]</div>
<p>Now we introduce our fitted value <span class="math notranslate nohighlight">\(f_i\)</span>, which we get from our straight line with slope <span class="math notranslate nohighlight">\(b\)</span> and intercept <span class="math notranslate nohighlight">\(c\)</span>:</p>
<div class="math notranslate nohighlight">
\[
f_i = b x_i + c
\]</div>
<p>Substituting, then simplifying:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
SSE = \Sigma y_i^2 - 2 \Sigma y_i (b x_i + c) + \Sigma (b x_i + c)^2 \\
= \Sigma y_i^2 - 2 \Sigma (y_i b x_i + y_i c)  +
\Sigma (b^2 x_i^2 + 2 b x_i c + c^2) \\
= \Sigma y_i^2 - 2 b \Sigma y_i x_i - 2 c \Sigma y_i +
b^2 \Sigma x_i^2 + 2 b c \Sigma x_i + n c^2
\end{split}\]</div>
<p>Now, let us assume our <span class="math notranslate nohighlight">\(y_i\)</span> and <span class="math notranslate nohighlight">\(x_i\)</span> values are z-scores.  In that case:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\Sigma y_i^2 = n \\
\Sigma y_i = 0 \\
\Sigma x_i^2 = n \\
\Sigma x_i = 0
\end{split}\]</div>
<p>and the equation above simplifies to:</p>
<div class="math notranslate nohighlight">
\[
SSE_z = n - 2 b \Sigma y_i x_i + b^2 n + n c^2
\]</div>
<p>Now differentiate with respect to <span class="math notranslate nohighlight">\(c\)</span>:</p>
<div class="math notranslate nohighlight">
\[
SSE_z' = 2 n c
\]</div>
<p>This is zero only when <span class="math notranslate nohighlight">\(c = 0\)</span>.   Differentiate again to give <span class="math notranslate nohighlight">\(2n\)</span>; the second
derivative is always positive, so the zero point of the first derivative is a trough
(minimum) rather than a peak (maximum).</p>
<p>We have discovered that, regardless of the slope <span class="math notranslate nohighlight">\(b\)</span>, the intercept <span class="math notranslate nohighlight">\(c\)</span> that
minimizes the sum (and mean) squared error is 0.</p>
<p>Now we have established the always-minimum value for <span class="math notranslate nohighlight">\(c\)</span>, substitute back into the equation above:</p>
<div class="math notranslate nohighlight">
\[
SSE_z = n - 2 b \Sigma y_i x_i + b^2 n
\]</div>
<p>Differentiate with respect to <span class="math notranslate nohighlight">\(b\)</span>:</p>
<div class="math notranslate nohighlight">
\[
SSE_z' = - 2 \Sigma y_i x_i + 2 b n
\]</div>
<p>This is zero when:</p>
<div class="math notranslate nohighlight">
\[
\frac{1}{n} \Sigma y_i x_i = b
\]</div>
<p>Differentiate again to get</p>
<div class="math notranslate nohighlight">
\[
SSE_z'' = 2 n
\]</div>
<p>The second derivative is always positive, so the zero for the first derivative
corresponds to a trough (minimum) rather than a peak (maximum).</p>
<p>We have discovered that the slope of the line that minimizes <span class="math notranslate nohighlight">\(SSE_z\)</span> is
<span class="math notranslate nohighlight">\(\frac{1}{n} \Sigma z_{x_i} z_{y_i}\)</span> — AKA the correlation.</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "nipraxis/textbook",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By The nipraxis team<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>